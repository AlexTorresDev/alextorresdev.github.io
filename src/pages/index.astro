---
import { getCollection } from 'astro:content'
import BaseLayout from '@/layouts/BaseLayout.astro'
import Social from '@/components/Social.astro'
import NoPost from '@/components/NoPost.astro'
import About from '@/components/About.astro'
import HorizontalCard from '@/components/Cards/HorizontalCard.astro'
import projects from '@/data/projects'

const posts = (await getCollection('blog')).sort(
	(a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
)

const last_posts = posts.slice(0, 3)
const last_projects = projects.slice(0, 3)
---

<BaseLayout>
	<div class="pb-12 mt-5">
		<div class="mt-12">
			<span class="block mb-1 text-xl py-1 opacity-7 dark:text-white/70">Hola 👋</span>
			<h1
				class="mb-4 text-4xl font-extrabold leading-none tracking-tight text-neutral-800 md:text-5xl lg:text-6xl dark:text-white"
			>
				Soy Alex
			</h1>
			<span
				class="block mb-1 text-3xl py-3 font-bold text-primary-600 contrast-200"
			>
				Desarrollador y estudiante de ingeniería telemática
			</span>
		</div>

		<About />
		<div class="mt-8">
			<Social />
		</div>
	</div>

	<div>
		<h2 class="text-3xl font-bold dark:text-white mb-5 mt-28">
			🎊 Últimos proyectos
		</h2>
	</div>

	{
		last_projects.map((project) => (
			<>
				<HorizontalCard
					title={project.name}
					img={project.image}
					desc={project.description}
					url={project.repo}
					tags={[...project.tags, ...project.languages]}
					disableTransition
				/>
				<div class="my-6" />
			</>
		))
	}

	<div class="flex justify-center mt-4">
		<a
			href="/projects"
			class="text-white bg-primary-700 hover:bg-primary-800 hover:saturate-150 hover:scale-110 hover:-rotate-2 focus:outline-none font-medium rounded-md text-sm px-5 py-2.5 text-center inline-flex items-center dark:bg-primary-600 dark:hover:bg-primary-700"
		>
			Ver todos los proyectos
			<svg
				class="rtl:rotate-180 w-3.5 h-3.5 ms-2"
				aria-hidden="true"
				xmlns="http://www.w3.org/2000/svg"
				fill="none"
				viewBox="0 0 14 10"
			>
				<path
					stroke="currentColor"
					stroke-linecap="round"
					stroke-linejoin="round"
					stroke-width="2"
					d="M1 5h12m0 0L9 1m4 4L9 9"></path>
			</svg>
		</a>
	</div>

	<div>
		<div class="text-3xl font-bold dark:text-white mb-5 mt-28">
			📝 Últimas publicaciones
		</div>
	</div>

	{
		last_posts.length === 0 ? (
			<NoPost />
		) : (
			last_posts.map((post) => (
				<>
					<HorizontalCard
						title={post.data.title}
						img={post.data.heroImage?.source}
						desc={post.data.description}
						url={'/blog/' + post.slug}
						target="_self"
						tags={post.data.tags}
						disableTransition
					/>
					<div class="my-6" />
				</>
			))
		)
	}

	<div class="flex justify-center mt-4 mb-8">
		<a
			href="/blog"
			class="text-white bg-primary-700 hover:bg-primary-800 hover:saturate-150 hover:scale-110 hover:-rotate-2 focus:outline-none font-medium rounded-md text-sm px-5 py-2.5 text-center inline-flex items-center dark:bg-primary-600 dark:hover:bg-primary-700"
		>
			Ver todas las publicaciones
			<svg
				class="rtl:rotate-180 w-3.5 h-3.5 ms-2"
				aria-hidden="true"
				xmlns="http://www.w3.org/2000/svg"
				fill="none"
				viewBox="0 0 14 10"
			>
				<path
					stroke="currentColor"
					stroke-linecap="round"
					stroke-linejoin="round"
					stroke-width="2"
					d="M1 5h12m0 0L9 1m4 4L9 9"></path>
			</svg>
		</a>
	</div>
</BaseLayout>
